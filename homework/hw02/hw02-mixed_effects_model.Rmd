---
title: "hw02 - mixed effects model"
author: "Sandra Emry"
date: "`r format(Sys.Date())`" 
output: word_document
---

## Read in and explore data

```{r}
#load packages
library(nlme)
library(tidyverse)
library(visreg)
library(lsmeans)

aging <- read.csv("./data/Aging Data Combined.csv")

# structure of data frame
str(aging)

# first few rows of dataframe
head(aging)

# delete rows with NAs
aging <- aging %>% 
  na.omit()

```

## Explain (in a paragraph) the purpose of the study that yielded the data.
Explain the specific data set you are using. For example, say where the data are from, give the meaning of the variables, and so on.
The dataset used in the assignment is from a paper published by a former graduate student in my supervisor's lab. The paper is entitled Divergent growth strategies between red algae and kelps influence biomechanical properties, and was published in 2015 in American Journal of Botany. The variables used in this analysis are standistance, stanstrain and Species. Macroalgae form new tissue at the base of the meristem, so as distance along the thallus increases, so does the age of tissue. The variable standistance, the fixed factor, is the distance along the thallus, standardized to the mean length of thalli. This is to control for differences in the length of indiviudals, as well as to account for how material properties differ along the thallus in different species. Stanstrain, the response variable, describe show extensible the tissue it, calculated by the change in length divided by original length. Species is included as a random factor in case the outcome is due to a phylogentic explanantion and not aging along the thallus. 

## Plot the data
```{r}
ggplot(data = aging, aes(x = standistance, y = stanstrain)) + geom_point(aes(color = Order)) +
  xlab("distance") + ylab("strain")

```

State what parameters you will estimate with these data.
I will fit a mixed effects model that will estimate the y-intercept and the coefficient of 
State what hypotheses you will test with these data.

## Fit a mixed effects model
Fit a linear model to the data in R. Explain in words the model you fit.

```{r}
# fit a linear model with position along the blade as a fixed factor, species as random factor and breaking strain as the response variable
z <- lme(stanstrain ~ standistance, random = ~1|Species, data = aging)

## check assumptions of the model 

# variances are homogenous: resisuals equal for all values of x
plot(z)

# errors are approximately normally distributed 
qqnorm(residuals(z))
qqline(residuals(z))


```

Interpret the output: Explain what the parameter estimates are telling you. Explain the null hypotheses and interpret the test results.

# Create a graph to visualize the model fit to the data. Explain what the graph is showing. (Can be similar to your initial graph, but with the model fit added.)

```{r}
visreg(z, points.par = list(cex = 0.8, col = "red"))

```

Statistical assumptions of a linear model were met by the data. Errors were approxiamtely normally distrubuted, as seen in the q-q plot, and variances were homogenous. Each data point is independent of each other, which is evident in the sample design. 

State the conclusions reached from your analyses. What did your estimates and tests tell you?

